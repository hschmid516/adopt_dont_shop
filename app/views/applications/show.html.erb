<h1><%= @app.name %>'s Application</h1>

<h3>Application Info</h3>
<ul>
  <li>Name: <%= @app.name %></li>
  <li>Address: <%= @app.street_address %><br>
  &emsp;&emsp;&emsp;&ensp;&nbsp;<%= @app.city %>, <%= @app.state %> <%= @app.zip %></li>
  <li>Description: <%= @app.description %></li>
  <li>Pets:
    <ul>
      <% @app.pets.each do |pet| %>
        <section id="app-<%= pet.id %>">
        <li><%= link_to pet.name, "/pets/#{pet.id}" %></li>
        </section>
      <% end %>
    </ul>
  </li>
  <li>Status: <%= @app.status %></li>
</ul>

<% if @app.pets != [] %>
  <p>Why Would You be a Good Pet Owner?</p>
  <%= form_with url: "/applications/#{@app.id}", method: :patch, local: true do |f| %>
    <%= f.text_field :description %>
    <%= f.submit 'Submit Application' %>
  <% end %>
<% end %>

<%  if @app.status == 'In Progress' %>
  <h3>Add a Pet to this Application</h3>

  <%= form_with url: "/applications/#{@app.id}", method: :get, local: true do |f| %>
    <%= f.label :search, 'Search for Pet by Name:' %>
    <%= f.text_field :search %>
    <%= f.submit 'Search' %>
  <% end %>

  <% if !@pets.nil? %>
    <% @pets.each do |pet| %>
    <section id='pet-<%= pet.id %>'>
    <h3><%= pet.name %></h3>
    <p>Age: <%= pet.age %></p>
    <p>Breed: <%= pet.breed %></p>
    <p>Adoptable: </p>
    <p>You can find <%= pet.name %> at <%= pet.shelter_name %>!</p>
    <%= button_to "Add Pet to Application", "/applications/#{@app.id}", method: :post, params: {pet_id: "#{pet.id}"} %>
    <% end %>
    </section>
  <% end %>
<% end %>
